
R version 2.15.1 (2012-06-22) -- "Roasted Marshmallows"
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: i386-apple-darwin9.8.0/i386 (32-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> require('optmatch')
Loading required package: optmatch
You're loading optmatch, by B. Hansen and M. Fredrickson.
 The optmatch package makes essential use of D. P. Bertsekas
 and P. Tseng's RELAX-IV algorithm and code, as well as
 Bertsekas' AUCTION algorithm and code.  Using the software
 to 'satisfy in any part commercial delivery requirements to
 government or industry' requires a special agreement with
 Dr. Bertsekas. For more information, enter
 relaxinfo() at the command line.

> data(nuclear, package="boot")
> mdist(pr ~ cap, data = nuclear)
         control
treatment          1           2           4          6            7          8
       3  3.95852869 0.000000000 0.000000000 8.41111160 1.635923e+00 10.2413535
       5  3.95852869 0.000000000 0.000000000 8.41111160 1.635923e+00 10.2413535
       9  0.50491437 1.635922572 1.635922572 2.62815897 0.000000e+00  3.6909310
       18 0.68288803 7.929718337 7.929718337 0.00709235 2.362196e+00  0.1476372
       20 3.65059326 0.006233511 0.006233511 7.95938985 1.440190e+00  9.7422570
       22 0.55079301 1.556133634 1.556133634 2.73155213 9.973617e-04  3.8132740
       24 0.49746187 1.649414659 1.649414659 2.61112070 2.770449e-05  3.6707344
       30 1.09712560 0.887679641 0.887679641 3.83385848 1.134776e-01  5.0987625
       31 0.09319791 2.836940022 2.836940022 1.47833942 1.642599e-01  2.2979214
       32 1.09712560 0.887679641 0.887679641 3.83385848 1.134776e-01  5.0987625
         control
treatment         10         11         12       13          14         15
       3  2.06478811 7.06533817 2.09515224 7.929718 0.006233511 1.28064016
       5  2.06478811 7.06533817 2.09515224 7.929718 0.006233511 1.28064016
       9  0.02493404 1.90174718 0.02836940 2.362196 1.440190333 0.02172032
       18 1.90174718 0.02493404 1.87282369 0.000000 7.491294745 2.83694002
       20 1.84412183 6.65184863 1.87282369 7.491295 0.000000000 1.10817970
       22 0.03590502 1.98984746 0.04000529 2.460270 1.365388203 0.01340897
       24 0.02329948 1.88725773 0.02662402 2.346044 1.452851286 0.02329948
       30 0.24479689 2.94432263 0.25532460 3.511157 0.745140028 0.03590502
       31 0.06119922 0.94818625 0.05610160 1.280640 2.577210405 0.30544203
       32 0.24479689 2.94432263 0.25532460 3.511157 0.745140028 0.03590502
         control
treatment         16          17         19         21         23          25
       3  2.28199133 1.340897432 0.01731531 0.64008459 2.15654539 7.694340970
       5  2.28199133 1.340897432 0.01731531 0.64008459 2.15654539 7.694340970
       9  0.05363590 0.014655676 1.98984746 0.22942090 0.03590502 2.234533539
       18 1.70393710 2.748978258 8.68812882 4.06394429 1.81564161 0.001773088
       20 2.04968917 1.164281293 0.04432719 0.51998562 1.93089230 7.262566456
       22 0.06926123 0.008006598 1.90174718 0.20016496 0.04887072 2.329947811
       24 0.05122561 0.015957788 2.00472477 0.23449082 0.03393800 2.218825092
       30 0.32314520 0.046571252 1.15295016 0.02019657 0.27704492 3.355124848
       31 0.03017019 0.277044924 3.29752721 0.78193159 0.04657125 1.187109795
       32 0.32314520 0.046571252 1.15295016 0.02019657 0.27704492 3.355124848
         control
treatment        26        27           28         29
       3  0.1170515 2.8369400 1.649415e+00 0.88767964
       5  0.1170515 2.8369400 1.649415e+00 0.88767964
       9  2.6281590 0.1642599 2.770449e-05 0.11347760
       18 9.9736173 1.2806402 2.346044e+00 3.51115655
       20 0.1773088 2.5772104 1.452851e+00 0.74514003
       22 2.5267605 0.1908562 1.357520e-03 0.09319791
       24 2.6452526 0.1600211 0.000000e+00 0.11705148
       30 1.6494147 0.5507930 1.170515e-01 0.00000000
       31 4.1064984 0.0000000 1.600211e-01 0.55079301
       32 1.6494147 0.5507930 1.170515e-01 0.00000000
> mdist(pr ~ cap, data = nuclear,
+            inv.scale.matrix = matrix(1,1,1, dimnames=list("cap", "cap")))
         control
treatment      1      2      4      6     7      8    10     11    12     13
       3  142884      0      0 303601 59049 369664 74529 255025 75625 286225
       5  142884      0      0 303601 59049 369664 74529 255025 75625 286225
       9   18225  59049  59049  94864     0 133225   900  68644  1024  85264
       18  24649 286225 286225    256 85264   5329 68644    900 67600      0
       20 131769    225    225 287296 51984 351649 66564 240100 67600 270400
       22  19881  56169  56169  98596    36 137641  1296  71824  1444  88804
       24  17956  59536  59536  94249     1 132496   841  68121   961  84681
       30  39601  32041  32041 138384  4096 184041  8836 106276  9216 126736
       31   3364 102400 102400  53361  5929  82944  2209  34225  2025  46225
       32  39601  32041  32041 138384  4096 184041  8836 106276  9216 126736
         control
treatment     14     15    16    17     19     21    23     25     26     27
       3     225  46225 82369 48400    625  23104 77841 277729   4225 102400
       5     225  46225 82369 48400    625  23104 77841 277729   4225 102400
       9   51984    784  1936   529  71824   8281  1296  80656  94864   5929
       18 270400 102400 61504 99225 313600 146689 65536     64 360000  46225
       20      0  40000 73984 42025   1600  18769 69696 262144   6400  93025
       22  49284    484  2500   289  68644   7225  1764  84100  91204   6889
       24  52441    841  1849   576  72361   8464  1225  80089  95481   5776
       30  26896   1296 11664  1681  41616    729 10000 121104  59536  19881
       31  93025  11025  1089 10000 119025  28224  1681  42849 148225      0
       32  26896   1296 11664  1681  41616    729 10000 121104  59536  19881
         control
treatment    28     29
       3  59536  32041
       5  59536  32041
       9      1   4096
       18 84681 126736
       20 52441  26896
       22    49   3364
       24     0   4225
       30  4225      0
       31  5776  19881
       32  4225      0
> mdist(pr ~ date + cum.n, data = nuclear)
         control
treatment          1         2           4          6          7          8
       3   4.1066172  0.000000  3.04790077  0.3278118 0.70846152 1.59968268
       5   0.3167930  3.047901  0.00000000  2.6417861 2.01661416 5.51924727
       9   2.4972006  1.121392  2.62946737  0.2383371 0.08415131 0.55379867
       18  4.5641583  1.376273  4.69296504  0.4895765 0.57320140 0.03461242
       20  1.8845975  2.465226  2.56453076  1.0281424 0.53625850 1.20410143
       22  5.2949917 13.701370  8.16559052 10.0481698 8.20549347 9.66611863
       24 11.1233929  9.018810 13.06011806  6.2818614 5.95458969 3.06274408
       30  0.5362585  2.614258  0.03328196  2.3965375 1.88459755 5.32656574
       31  1.7387231  1.837187  0.60100709  2.2627233 2.10446348 5.47784265
       32  0.5362585  2.614258  0.03328196  2.3965375 1.88459755 5.32656574
         control
treatment         10         11         12        13         14         15
       3  1.14431554 1.65043788 1.89953729 1.3762727 2.39164607  5.5459615
       5  4.38903563 4.49220860 3.06863879 4.6929650 3.09382288  0.8222879
       9  0.25850396 0.24866773 0.10312079 0.3115118 0.23833711  3.2227599
       18 0.01090601 0.03120595 0.38795644 0.0000000 0.61012120  5.4636145
       20 0.87675519 0.61853646 0.09687719 0.8724989 0.03461242  2.2151947
       22 9.21056626 7.95881752 5.93270896 8.9772536 5.08051980  4.0457400
       24 3.74377032 3.02944703 3.63769964 3.3518583 3.46391315 11.2309466
       30 4.20544103 4.39286314 3.09382288 4.5292663 3.18557088  1.1748812
       31 4.35044358 4.82116761 3.87805005 4.7509214 4.18496437  2.8076784
       32 4.20544103 4.39286314 3.09382288 4.5292663 3.18557088  1.1748812
         control
treatment         16       17        19         21       23         25
       3  1.22208758 6.982099 4.5584426  4.7930074 7.958818 10.9039416
       5  3.93590765 2.119374 9.0777759  0.5362585 2.629168  5.5711886
       9  0.13844967 3.486791 2.0213138  2.8266983 4.106617  5.5416195
       18 0.03461242 5.523431 0.9695125  4.9806045 6.230206  7.3402676
       20 0.61012120 2.020875 2.1944159  2.0166142 2.443220  3.3117061
       22 8.35761350 2.018017 8.7476304  4.6370839 1.650438  0.2528588
       24 3.71019744 9.159118 0.8225945 11.1438878 9.469942  7.7286803
       30 3.80119174 2.629168 9.0508934  0.8222879 3.205526  6.3423283
       31 4.09322503 4.826327 9.8409414  2.2399188 5.617851  9.4638025
       32 3.80119174 2.629168 9.0508934  0.8222879 3.205526  6.3423283
         control
treatment          26         27          28          29
       3  15.02517722  1.8371875  1.50776446  2.61425804
       5   9.01447615  0.6010071  0.81048100  0.03328196
       9   8.31280577  2.9855067  2.83402678  2.55271708
       18 10.05810167  4.7509214  4.44857922  4.52926633
       20  5.48432457  3.7550333  3.74377032  2.68526158
       22  0.03120595 12.6939455 13.24355062  9.07624572
       24  8.29992400 14.9982174 14.71082051 13.29237059
       30  9.98948462  0.3525588  0.51536468  0.00000000
       31 13.81383376  0.0000000  0.02429209  0.35255881
       32  9.98948462  0.3525588  0.51536468  0.00000000
> mdist(pr ~ date + cum.n, data = nuclear, exclusions = exactMatch(pr ~ pt, data = nuclear))
$`0`
       control
treated         1         2         4          6          7          8
     3   4.106617  0.000000  3.047901  0.3278118 0.70846152 1.59968268
     5   0.316793  3.047901  0.000000  2.6417861 2.01661416 5.51924727
     9   2.497201  1.121392  2.629467  0.2383371 0.08415131 0.55379867
     18  4.564158  1.376273  4.692965  0.4895765 0.57320140 0.03461242
     20  1.884598  2.465226  2.564531  1.0281424 0.53625850 1.20410143
     22  5.294992 13.701370  8.165591 10.0481698 8.20549347 9.66611863
     24 11.123393  9.018810 13.060118  6.2818614 5.95458969 3.06274408
       control
treated         10         11         12        13         14         15
     3  1.14431554 1.65043788 1.89953729 1.3762727 2.39164607  5.5459615
     5  4.38903563 4.49220860 3.06863879 4.6929650 3.09382288  0.8222879
     9  0.25850396 0.24866773 0.10312079 0.3115118 0.23833711  3.2227599
     18 0.01090601 0.03120595 0.38795644 0.0000000 0.61012120  5.4636145
     20 0.87675519 0.61853646 0.09687719 0.8724989 0.03461242  2.2151947
     22 9.21056626 7.95881752 5.93270896 8.9772536 5.08051980  4.0457400
     24 3.74377032 3.02944703 3.63769964 3.3518583 3.46391315 11.2309466
       control
treated         16       17        19         21       23         25
     3  1.22208758 6.982099 4.5584426  4.7930074 7.958818 10.9039416
     5  3.93590765 2.119374 9.0777759  0.5362585 2.629168  5.5711886
     9  0.13844967 3.486791 2.0213138  2.8266983 4.106617  5.5416195
     18 0.03461242 5.523431 0.9695125  4.9806045 6.230206  7.3402676
     20 0.61012120 2.020875 2.1944159  2.0166142 2.443220  3.3117061
     22 8.35761350 2.018017 8.7476304  4.6370839 1.650438  0.2528588
     24 3.71019744 9.159118 0.8225945 11.1438878 9.469942  7.7286803
       control
treated          26
     3  15.02517722
     5   9.01447615
     9   8.31280577
     18 10.05810167
     20  5.48432457
     22  0.03120595
     24  8.29992400

$`1`
       control
treated        27         28        29
     30 0.3525588 0.51536468 0.0000000
     31 0.0000000 0.02429209 0.3525588
     32 0.3525588 0.51536468 0.0000000

> 
> if ( (require(splines)) )
+   mdist(pr ~ ns(date,df=3) + cum.n, data = nuclear)
Loading required package: splines
         control
treatment         1         2          4         6          7           8
       3  12.473140  0.000000 10.8541429  5.896388  7.6468736  6.87090239
       5   2.564968 10.854143  0.0000000  3.113891  2.0480695  5.94438803
       9   3.305233  7.296690  3.0988153  1.372877  0.5493628  0.61458369
       18  5.682274  6.862115  5.1177604  1.326982  0.9351768  0.03841148
       20  2.788071  8.870138  7.5371323  7.231974  5.4588155  3.93651042
       22 15.364629 16.332787 13.2508482 12.550214 12.5360587 14.22654680
       24 16.037434  9.628042 19.0630458 11.098903 11.3255865  6.49368575
       30  3.045838  8.389416  0.2008351  2.544701  1.9401369  5.58821238
       31  9.550371  2.094804  9.3725803  9.152294 10.0407119 11.20651904
       32  3.045838  8.389416  0.2008351  2.544701  1.9401369  5.58821238
         control
treatment          10         11         12         13          14        15
       3   7.02657931  6.8116722  7.6774426  6.8621148  8.48860241 14.688054
       5   4.55974257  5.8997404  6.2335225  5.1177604  7.97343628  6.812327
       9   0.41773192  0.5047860  1.3009623  0.3457033  2.56106450  6.419680
       18  0.08925927  0.3466689  1.7650451  0.0000000  3.15586317  9.088699
       20  4.49905471  1.7460262  0.3008481  3.5077753  0.03841148  2.458335
       22 13.54489153 14.2468158 14.7419443 13.8046997 15.60631932 18.088235
       24  7.92044608  5.7925184  6.4419631  6.9015752  6.34642183 16.295966
       30  4.28793934  5.6092098  6.0373775  4.8317121  7.72654631  7.196583
       31 10.93229232  9.8410653  8.8946952 10.6566258  9.11236105 10.441861
       32  4.28793934  5.6092098  6.0373775  4.8317121  7.72654631  7.196583
         control
treatment          16        17        19        21        23        25
       3   6.93015022 14.545599  8.793842 13.484746 14.492738 11.995416
       5   4.36795576 10.177743 15.338569  4.680266 10.168764  9.097496
       9   0.15364592  8.126692  5.390790  4.767431  8.355089  7.690783
       18  0.03841148 10.474839  4.402378  7.305734 10.719632  9.140096
       20  3.15586317  2.392706  2.596082  2.328624  2.743619  6.061344
       22 13.45967564 16.040162 18.290887 16.831713 14.369994  3.205787
       24  7.38628766 13.056126  2.460209 15.999360 12.638883  8.067153
       30  4.15203483 10.232173 14.496326  5.115267 10.179186  8.686368
       31 10.18355550 10.600980 12.847145  9.832048 10.508009 10.654103
       32  4.15203483 10.232173 14.496326  5.115267 10.179186  8.686368
         control
treatment         26        27         28         29
       3  19.4621274  2.094804  2.1911808  8.3894160
       5  15.7116098  9.372580 12.4654888  0.2008351
       9  16.2534456  9.467884 11.7425148  3.0231491
       18 17.0015410 10.656626 12.7108365  4.8317121
       20 20.1643444  8.952791 10.3977406  7.3603697
       22  0.3335321 17.112532 19.2200919 12.5886257
       24 14.9053375 15.335222 15.7095499 17.7507584
       30 15.0171317  7.104341  9.8294536  0.0000000
       31 20.5861556  0.000000  0.2299599  7.1043411
       32 15.0171317  7.104341  9.8294536  0.0000000
> 
> if (require(splines))
+   mdist(pr ~ ns(date,df=3) + cum.n, data = nuclear, exactMatch(pr ~ pt, data = nuclear)
+ )
$`0`
       control
treated         1         2         4         6          7           8
     3  12.473140  0.000000 10.854143  5.896388  7.6468736  6.87090239
     5   2.564968 10.854143  0.000000  3.113891  2.0480695  5.94438803
     9   3.305233  7.296690  3.098815  1.372877  0.5493628  0.61458369
     18  5.682274  6.862115  5.117760  1.326982  0.9351768  0.03841148
     20  2.788071  8.870138  7.537132  7.231974  5.4588155  3.93651042
     22 15.364629 16.332787 13.250848 12.550214 12.5360587 14.22654680
     24 16.037434  9.628042 19.063046 11.098903 11.3255865  6.49368575
       control
treated          10         11         12         13          14        15
     3   7.02657931  6.8116722  7.6774426  6.8621148  8.48860241 14.688054
     5   4.55974257  5.8997404  6.2335225  5.1177604  7.97343628  6.812327
     9   0.41773192  0.5047860  1.3009623  0.3457033  2.56106450  6.419680
     18  0.08925927  0.3466689  1.7650451  0.0000000  3.15586317  9.088699
     20  4.49905471  1.7460262  0.3008481  3.5077753  0.03841148  2.458335
     22 13.54489153 14.2468158 14.7419443 13.8046997 15.60631932 18.088235
     24  7.92044608  5.7925184  6.4419631  6.9015752  6.34642183 16.295966
       control
treated          16        17        19        21        23        25
     3   6.93015022 14.545599  8.793842 13.484746 14.492738 11.995416
     5   4.36795576 10.177743 15.338569  4.680266 10.168764  9.097496
     9   0.15364592  8.126692  5.390790  4.767431  8.355089  7.690783
     18  0.03841148 10.474839  4.402378  7.305734 10.719632  9.140096
     20  3.15586317  2.392706  2.596082  2.328624  2.743619  6.061344
     22 13.45967564 16.040162 18.290887 16.831713 14.369994  3.205787
     24  7.38628766 13.056126  2.460209 15.999360 12.638883  8.067153
       control
treated         26
     3  19.4621274
     5  15.7116098
     9  16.2534456
     18 17.0015410
     20 20.1643444
     22  0.3335321
     24 14.9053375

$`1`
       control
treated       27        28       29
     30 7.104341 9.8294536 0.000000
     31 0.000000 0.2299599 7.104341
     32 7.104341 9.8294536 0.000000

> cum.n.q <- cut(nuclear$cum.n, quantile(nuclear$cum.n), include.lowest=TRUE)
> mdist(pr ~ date + cum.n.q, data = nuclear)
         control
treatment         1         2           4          6          7        8
       3   6.630460  0.000000 10.71828666  0.6766820 10.4168199 2.309583
       5  13.187133 10.718287  0.00000000  8.2770816 11.0626083 7.267705
       9  13.146999 11.437002 10.76165131  9.4193253  0.1214956 8.768872
       18  9.540020  2.309583  7.26770550  0.4859824  8.8081320 0.000000
       20 20.200667 17.225419  1.64534218 12.6738835 14.2625759 9.876092
       22 10.644182 15.986618 10.17743331 11.6204789 12.9336652 8.979803
       24 22.845133 14.700969 10.88673151  9.0695989 15.2322431 5.356693
       30 12.251364  9.876092  0.05617957  7.8248393 10.8315201 7.145931
       31  9.904349  7.848331  1.09346051  7.1275043 10.8887111 7.576076
       32 12.251364  9.876092  0.05617957  7.8248393 10.8315201 7.145931
         control
treatment          10        11        12       13         14        15
       3   1.94392980 3.0373903 13.155709 2.309583 14.2063384  6.668029
       5   7.37766219 7.1499841 10.736456 7.267705 10.8887111 11.427954
       9   8.81422246 8.7660058  0.211694 8.768872  0.4859824 11.631888
       18  0.01574583 0.0497646  9.089117 0.000000  9.4193253  8.136749
       20 10.30796347 9.1860777 11.861862 9.876092 11.4060556 17.225366
       22  9.38339371 8.3400658 10.715206 8.979803 10.3128184  7.775719
       24  5.95328501 4.3738420 11.769997 5.356693 11.0030512 19.247554
       30  7.19640366 7.1339596 10.888711 7.145931 11.1533250 10.716903
       31  7.42360169 7.9248973 12.253778 7.576076 12.9017349  9.136574
       32  7.19640366 7.1339596 10.888711 7.145931 11.1533250 10.716903
         control
treatment       16        17        19        21        23         25
       3  2.309583  7.769399  6.581369  6.593065  8.340066 12.1990232
       5  7.267705  9.464282  7.576076 12.251364  9.136574  9.0321160
       9  8.768872 10.084567  9.615626 12.333264  9.878893 10.3128184
       18 0.000000  6.780214  1.093461  8.782205  6.630460  7.3110921
       20 9.876092 13.187133  7.501839 18.656837 12.251364  9.4642822
       22 8.979803  3.919740  6.841224  9.153771  3.037390  0.4859824
       24 5.356693 14.147788  1.609768 20.990164 12.900880  8.7411266
       30 7.145931  9.136574  7.950003 11.427954  8.921226  9.3124694
       31 7.576076  8.864122 10.071367  9.464282  9.032116 11.1145788
       32 7.145931  9.136574  7.950003 11.427954  8.921226  9.3124694
         control
treatment         26        27        28          29
       3  17.4039268  7.848331  8.766006  9.87609201
       5  10.7492138  1.093461 14.696348  0.05617957
       9  12.5036942 11.316728  3.037390 10.69579716
       18  9.7190696  7.576076 11.395085  7.14593123
       20  8.8206716  5.421426 21.473147  2.30958299
       22  0.0497646 13.717843 19.830005 10.78825478
       24  6.8895650 16.035487 24.273043 11.86211122
       30 11.4657851  0.653938 13.804324  0.00000000
       31 14.7561671  0.000000 11.606556  0.65393798
       32 11.4657851  0.653938 13.804324  0.00000000
> mdist(pr ~ date + cum.n.q, data = nuclear, exclusions = exactMatch(pr~pt, data = nuclear))
$`0`
       control
treated        1         2         4          6          7        8          10
     3   6.63046  0.000000 10.718287  0.6766820 10.4168199 2.309583  1.94392980
     5  13.18713 10.718287  0.000000  8.2770816 11.0626083 7.267705  7.37766219
     9  13.14700 11.437002 10.761651  9.4193253  0.1214956 8.768872  8.81422246
     18  9.54002  2.309583  7.267705  0.4859824  8.8081320 0.000000  0.01574583
     20 20.20067 17.225419  1.645342 12.6738835 14.2625759 9.876092 10.30796347
     22 10.64418 15.986618 10.177433 11.6204789 12.9336652 8.979803  9.38339371
     24 22.84513 14.700969 10.886732  9.0695989 15.2322431 5.356693  5.95328501
       control
treated        11        12       13         14        15       16        17
     3  3.0373903 13.155709 2.309583 14.2063384  6.668029 2.309583  7.769399
     5  7.1499841 10.736456 7.267705 10.8887111 11.427954 7.267705  9.464282
     9  8.7660058  0.211694 8.768872  0.4859824 11.631888 8.768872 10.084567
     18 0.0497646  9.089117 0.000000  9.4193253  8.136749 0.000000  6.780214
     20 9.1860777 11.861862 9.876092 11.4060556 17.225366 9.876092 13.187133
     22 8.3400658 10.715206 8.979803 10.3128184  7.775719 8.979803  3.919740
     24 4.3738420 11.769997 5.356693 11.0030512 19.247554 5.356693 14.147788
       control
treated       19        21        23         25         26
     3  6.581369  6.593065  8.340066 12.1990232 17.4039268
     5  7.576076 12.251364  9.136574  9.0321160 10.7492138
     9  9.615626 12.333264  9.878893 10.3128184 12.5036942
     18 1.093461  8.782205  6.630460  7.3110921  9.7190696
     20 7.501839 18.656837 12.251364  9.4642822  8.8206716
     22 6.841224  9.153771  3.037390  0.4859824  0.0497646
     24 1.609768 20.990164 12.900880  8.7411266  6.8895650

$`1`
       control
treated       27       28       29
     30 0.653938 13.80432 0.000000
     31 0.000000 11.60656 0.653938
     32 0.653938 13.80432 0.000000

> 
> ### should give error, incorrect mode
> try(mdist(as.factor(pr) ~ cap, data = nuclear))
         control
treatment          1           2           4          6            7          8
       3  3.95852869 0.000000000 0.000000000 8.41111160 1.635923e+00 10.2413535
       5  3.95852869 0.000000000 0.000000000 8.41111160 1.635923e+00 10.2413535
       9  0.50491437 1.635922572 1.635922572 2.62815897 0.000000e+00  3.6909310
       18 0.68288803 7.929718337 7.929718337 0.00709235 2.362196e+00  0.1476372
       20 3.65059326 0.006233511 0.006233511 7.95938985 1.440190e+00  9.7422570
       22 0.55079301 1.556133634 1.556133634 2.73155213 9.973617e-04  3.8132740
       24 0.49746187 1.649414659 1.649414659 2.61112070 2.770449e-05  3.6707344
       30 1.09712560 0.887679641 0.887679641 3.83385848 1.134776e-01  5.0987625
       31 0.09319791 2.836940022 2.836940022 1.47833942 1.642599e-01  2.2979214
       32 1.09712560 0.887679641 0.887679641 3.83385848 1.134776e-01  5.0987625
         control
treatment         10         11         12       13          14         15
       3  2.06478811 7.06533817 2.09515224 7.929718 0.006233511 1.28064016
       5  2.06478811 7.06533817 2.09515224 7.929718 0.006233511 1.28064016
       9  0.02493404 1.90174718 0.02836940 2.362196 1.440190333 0.02172032
       18 1.90174718 0.02493404 1.87282369 0.000000 7.491294745 2.83694002
       20 1.84412183 6.65184863 1.87282369 7.491295 0.000000000 1.10817970
       22 0.03590502 1.98984746 0.04000529 2.460270 1.365388203 0.01340897
       24 0.02329948 1.88725773 0.02662402 2.346044 1.452851286 0.02329948
       30 0.24479689 2.94432263 0.25532460 3.511157 0.745140028 0.03590502
       31 0.06119922 0.94818625 0.05610160 1.280640 2.577210405 0.30544203
       32 0.24479689 2.94432263 0.25532460 3.511157 0.745140028 0.03590502
         control
treatment         16          17         19         21         23          25
       3  2.28199133 1.340897432 0.01731531 0.64008459 2.15654539 7.694340970
       5  2.28199133 1.340897432 0.01731531 0.64008459 2.15654539 7.694340970
       9  0.05363590 0.014655676 1.98984746 0.22942090 0.03590502 2.234533539
       18 1.70393710 2.748978258 8.68812882 4.06394429 1.81564161 0.001773088
       20 2.04968917 1.164281293 0.04432719 0.51998562 1.93089230 7.262566456
       22 0.06926123 0.008006598 1.90174718 0.20016496 0.04887072 2.329947811
       24 0.05122561 0.015957788 2.00472477 0.23449082 0.03393800 2.218825092
       30 0.32314520 0.046571252 1.15295016 0.02019657 0.27704492 3.355124848
       31 0.03017019 0.277044924 3.29752721 0.78193159 0.04657125 1.187109795
       32 0.32314520 0.046571252 1.15295016 0.02019657 0.27704492 3.355124848
         control
treatment        26        27           28         29
       3  0.1170515 2.8369400 1.649415e+00 0.88767964
       5  0.1170515 2.8369400 1.649415e+00 0.88767964
       9  2.6281590 0.1642599 2.770449e-05 0.11347760
       18 9.9736173 1.2806402 2.346044e+00 3.51115655
       20 0.1773088 2.5772104 1.452851e+00 0.74514003
       22 2.5267605 0.1908562 1.357520e-03 0.09319791
       24 2.6452526 0.1600211 0.000000e+00 0.11705148
       30 1.6494147 0.5507930 1.170515e-01 0.00000000
       31 4.1064984 0.0000000 1.600211e-01 0.55079301
       32 1.6494147 0.5507930 1.170515e-01 0.00000000
> 
> proc.time()
   user  system elapsed 
  2.193   0.125   4.686 
